## 数据链路层概述

![image-20221006170529420](http://pic.shixiaocaia.fun/202210061705679.png)

上图为两台主机通过互联网通信的流程。

> 涉及的概念：
>
> 链路：两个直接相连的节点，比如主机H1到路由器R1。同时这三段链路可能采用不同的协议。
>
> 数据链路：在链路基础上，加上实现必要通信协议来控制数据传输的硬件和软件（比如网卡和其软件），构成了数据链路。
>
> 帧：是数据链路层对等实体之间在水平方向进行逻辑通信的协议数据单元PDU。

## 封装成帧和透明传输

### 封装成帧

在网络层交付下来的分组的基础上添加一个首部和尾部，构成一个帧。

![image-20221006171810194](http://pic.shixiaocaia.fun/202210061718206.png)

> 帧首部包含了帧开始符、帧的源地址和目的地址。
>
> 帧尾部包含了帧校验序列和帧结束符。
>
> 接收方根据帧开始和结束符号进行帧定界。

> 在上图中，我们可以看到数据载荷部分，为了提高数据链路层传输帧的效率，应该使帧的数据载荷长度尽可能大于首尾的长度。
>
> 综合考虑其他因素，设置了一个上限，即最大传输单元（Maximum Transfer Unit MTU）。例如上述MTU  = 1500B

### 透明传输

上述的帧封装中，帧开始符和帧结束符可能出现在数据载荷部分，造成帧定界的误判。

考虑帧定界符，有了透明传输这一技术的出现。

> 字节填充：当使用面向字节的物理链路中，在发送方的数据链路层中的数据载荷出现帧定界符的前面插入转义字符“ ESC ”，接收端再去除这些。

> 比特填充：当使用面向比特的物理链路中，针对比特构成的帧定界符加如特定的比特避免形成帧定界符。

## 差错检测FCS

检测在传输过程中，不可避免产生的误码。

 **奇偶校验**

在待发送的数据后面增加一个校验位，使得整个数据中的 “1” 的个数为奇数或者偶数，再对比接收方的个数，判断是否发生误码。

但是发生多为错码时，奇偶性不变，无法检错。

**循环冗余校验CRC**

利用一个收发方规定好的生成多项式，生成冗余码放到待发送的数据后面，接收到后进行检查。更加被广泛运用到数据链路层当中，但是无法具体检测到错在哪些帧和比特。

## 可靠传输

