## 报文的结构

请求报文和响应报文的结构如下。

<img src="http://pic.shixiaocaia.fun/202211200908006.png" alt="image-20221120090750316" style="zoom:50%;" />

## 编码提升传输速率

### 报文主体和实体主体

- 报文（message） 

是 HTTP 通信中的基本单位，由 8 位组字节流组成，通过 HTTP 通信传输。 

- 实体（entity）

作为请求或响应的有效载荷数据（补充项）被传输，其内容由实体首部和实体主体组成。

> HTTP 报文的主体用于传输请求或响应的实体主体。 通常，报文主体等于实体主体。
>
> 只有当传输中进行编码操作时，实体主体的内容发生变化，才导致它和报文主体产生差异。

### 内容编码

HTTP协议中有类似zip压缩文件的功能，内容编码指明应用在实体内容上的编码格式，并保持实体信息原样压缩。内容编码后的实体由客户端接收并负责解码。

常见的内容编码包括：gzip、compress、deflate。

### 分块传输编码

在传输大容量时，通过把文件分块传输，这样每一块传输完成时，浏览器能够逐步显示画面。

使用分块传输编码的实体主体会由接收的客户端负责解码，恢复到编 码前的实体主体。

## 发送多种数据的多部份对象集合

发送邮件时，允许发送多份不同类型的文件。

是因为采用了 MIME（Multipurpose Internet Mail Extensions，多用途因特网邮 件扩展）机制，它允许邮件处理文本、图片、视频等多个不同类型的文件。

在 HTTP 报文中使用多部分对象集合时，需要在首部字段里加上 Content-type。

使用 boundary 字符串来划分多部分对象集合指明的各类实体。

```
--THIS_STRING_SEPARATES //表开始

--THIS_STRING_SEPARATES-- //表结束
```

## 获取部分内容的范围请求

实现指定下载的实体范围的功能。像这样，指定范围发送的请 求叫做范围请求（Range Request）。

## 内容协商返回最合适的内容

内容协商机制是指客户端和服务器端就响应的资源内容进行交涉，然 后提供给客户端最为适合的资源。内容协商会以响应资源的语言、字符集、编码方式等作为判断的基准。

包括：

- 服务器驱动协商（Server-driven Negotiation）
- 客户端驱动协商（Agent-driven Negotiation）
- 透明协商（Transparent Negotiation）

## 状态码告知从服务器端返回的请求结果

状态码的职责是当客户端向服务器端发送请求时，描述返回的请求结果。

数字中的第一位指定了响应类别，后两位无分类。响应类别有以下 5 种。

<img src="http://pic.shixiaocaia.fun/202211200934573.png" alt="image-20221120093436233" style="zoom:50%;" />

> 200 OK : 表示从客户端发来的请求在服务器端被正常处理了。
>
> 204 No Content：该状态码代表服务器接收的请求已成功处理，但在返回的响应报文中不含实体的主体部分。
>
> 一般在只需要从客户端往服务器发送信息，而对客户端不需要发送新信息内容的情况下使用。
>
> 206 Partial Content：该状态码表示客户端进行了范围请求，而服务器成功执行了这部分的 GET 请求。响应报文中包含由 Content-Range 指定范围的实体内容。

> 3XX 重定向：3XX 响应结果表明浏览器需要执行某些特殊的处理以正确处理请求。
>
> 301 Moved Permanently ：永久性重定向。该状态码表示请求的资源已被分配了新的 URI，以后 应使用资源现在所指的 URI。
>
> 302 Found：临时性重定向。该状态码表示请求的资源已被分配了新的 URI，希望 用户（本次）能使用新的 URI 访问。
>
> 303 See Other：该状态码表示由于请求对应的资源存在着另一个 URI，应使用 GET 方法定向获取请求的资源。
>
> 304 Not Modified：该状态码表示客户端发送附带条件的请求时，服务器端允许请求访问资源，但未满足条件的情况。
>
> 307 Temporary Redirect：临时重定向。

> 4XX 客户端错误
>
> 400 Bad Request：该状态码表示请求报文中存在语法错误。当错误发生时，需修改请求 的内容后再次发送请求。另外，浏览器会像 200 OK 一样对待该状态码。
>
> 401 Unauthorized：该状态码表示发送的请求需要有通过 HTTP 认证（BASIC 认证、 DIGEST 认证）的认证信息。另外若之前已进行过 1 次请求，则表示用户认证失败。
>
> 403 Forbidden：该状态码表明对请求资源的访问被服务器拒绝了。
>
> 404 Not Found：该状态码表明服务器上无法找到请求的资源。除此之外，也可以在服务器端拒绝请求且不想说明理由时使用。

> 5XX 服务器错误
>
> 500 Internal Server Error：该状态码表明服务器端在执行请求时发生了错误。也有可能是 Web 应用存在的 bug 或某些临时的故障。
>
> 503 Service Unavailable：该状态码表明服务器暂时处于超负载或正在进行停机维护，现在无法 处理请求。
