## 网络层概述

网络层的主要任务就是将分组从源主机经过多个网络和多段链路传输到目的主机，可以将该任务划分为分组转发和路由选择两种重要的功能，向上提供面向连接的虚电路服务，无连接的数据报服务。

位于OSI体系结构的第三层。

### 分组转发

当路由器收到某个接口所连接的链路上收到一个分组之后，将分组从自己其他适当的接口转发给下一跳路由器或者目的主机。

每个路由器会构建一个路由表，在此基础上维护成一个转发表，根据分组首部的转发标识在转发表中查询。

### 路由选择

源主机和目的主机之间存在多条路径，网络层需要决定选择哪一条路径来传送分组。

一般分为：

1. 集中式路由选择，由某个网路控制中心执行路由选择。
2. 分布式路由选择，在每个路由器上运行路由选择协议，各路由器相互交换路由信息并各自计算路由。
3. 人工路由选择，网络维护人员配置路由。

### 虚电路服务

<img src="http://pic.shixiaocaia.fun/202210180929190.png" alt="image-20221018092941879" style="zoom:50%;" />

> 1. 核心思想是“可靠通信应由网络自身来保证”。
> 2. 必须首先建立网络层连接一虚电路，以保证通信双方所需的一切网络资源。是一条逻辑链路。
> 3. 通信双方沿着已建立的虚电路发送分组。
> 4. 这种通信方式如果再使用可靠传输的网络协议，就可使所发送的分组最终正确（无差错按序到达、不丢失、不重复）到达接收方。

### 无连接的数据报服务

<img src="http://pic.shixiaocaia.fun/202210180949041.png" alt="image-20221018094911308" style="zoom:50%;" />

> 1. 核心思想是 可靠通信应由用户主机来保证
> 2. 不需要建立网络层连接
> 3. **每个分组可走不同的路径 因此，每个分组的首部都必须携带目的主机的完整地址。**
> 4. 通信结束后，没有需要释放的连接

由于网络自身不提供端到端的可靠传输服务，这就使得网络中的路由器可以做得比较简单，大大降低了网络造价。

## 网际协议（IP）

网际协议（Internet Protocol，IP）是TCP/IP体系结构网际层中的核心协议。

要将众多的异构型网络都互连起来，并且能够互相通信，则会面临许多需要解决的问题。

- 不同的网络接入机制
- 不同的差错恢复方法
- 不同的路由选择技术
- 不同的寻址方案
- 不同的最大分组长度
- 不同的服务（面向连接服务和无连接服务）
